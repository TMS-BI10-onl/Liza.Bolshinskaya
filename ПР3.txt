Автосалон
Таблица Автосалон (id салона, город, id поставщика)
Таблица Поставщик (id поставщика, название)
Таблица Сервис (id сервис-центра, id салона, адрес)
Таблица Классы (id класса, класс)
Таблица Автомобили (id авто, модель, id класса)
Таблица Покупки (id авто, id_салона, дата, цена)
Таблица Техобслуживание (id авто, id сервис-центра, услуга, стоимость)

1. Вывести для каждого автомобиля стоимость продажи и сумму всех ремонтов.

SELECT t1.id_авто, t1.цена, t2.ТО_cost
FROM Покупки t1
	JOIN (SELECT id_авто, SUM(стоимость)AS ТО_cost FROM Техобслуживание GROUP BY id_авто) t2
	ON t1.id_авто=t2.id_авто


2. Для каждого салона вывести проданное количество автомобилей каждого класса. Результаты отобразить в транспонированной таблице.

SELECT t1.id_салона, t3.[Class_A], t3.[Class_B], t3.[Class_C], t3.[Class_D], t3.[Class_E], t3.[Class_F], t3.[Class_S], t3.[Class_M]
FROM
Покупки t1
JOIN (SELECT id_авто, id_класса FROM Автомобили) t2
ON t1.id_авто=t2.id_авто
JOIN (SELECT класс, id_класса FROM Классы) t3
ON t2.id_класса=t3.id_класса
PIVOT
(
COUNT(id_авто)
FOR класс IN ([Class_A], [Class_B], [Class_C], [Class_D], [Class_E], [Class_F], [Class_S], [Class_M])
) AS PivotTable;
